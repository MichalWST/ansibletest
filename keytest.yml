---
- name: Perform tasks on localhost
  hosts: localhost
  gather_facts: false

  tasks:
    - name: Generate SSH keys
      ansible.builtin.command: >
        ssh-keygen -t ed25519 -f ~/.ssh/ansnixkey -N '' -C "Key generated by Ansible"
      ignore_errors: yes

- name: Copy ssh key
  hosts: dns
  become: true
  tasks:

    - name: add ssh key for ansnix
      authorized_key:
       user: ansnix
       key: "{{ lookup('file', '~/.ssh/ansnixkey.pub') }}"
